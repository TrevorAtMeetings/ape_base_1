Final Recommendations (Refined)
Your application is now very close to mirroring reality. You have successfully implemented the first major finding (zero penalty for small trims). To close the final gap, you need to account for the BEP shift in your efficiency calculation.
Refined Step 5: Calculate Final Performance (The Missing Piece)
Your logic should be updated to predict the location of the new BEP after trimming and use the efficiency value at that new BEP.
Pseudo-code Implementation:
code
Python
# --- Continuing from our previous logic plan ---

# You have already calculated:
# - pump_specific_speed
# - bep_shift_flow_exponent (e.g., 1.4 for this pump)
# - diameter_ratio (e.g., 0.867 for this pump)

# --- NEW LOGIC TO IMPLEMENT ---

# 5a. Predict the location of the NEW Best Efficiency Point
new_bep_flow = pump.base_bep_flow * (diameter_ratio ** bep_shift_flow_exponent)
new_bep_head = pump.base_bep_head * (diameter_ratio ** 2.2) # Using our refined head shift exponent

# 5b. Get the efficiency at the ORIGINAL BEP from the full-size curve
base_bep_efficiency = pump.get_efficiency_at_flow(pump.base_bep_flow) # This is the peak efficiency

# 5c. Calculate the final efficiency
# Since epsilon is 0 for this trim, the efficiency at the new BEP is the same as the original BEP.
final_bep_efficiency = base_bep_efficiency - efficiency_loss_percentage_points # efficiency_loss is 0 here

# 5d. Compare the Target Flow to the New BEP Flow
q_ratio = target_flow / new_bep_flow

# THIS IS THE KEY INSIGHT:
# Your application's final reported efficiency should be based on this final_bep_efficiency,
# potentially with a minor adjustment if the q_ratio is far from 1.0.
# For now, simply using `final_bep_efficiency` will be far more accurate.

# Your final reported efficiency is `final_bep_efficiency` (87.1%), NOT the efficiency
# on the old curve at the target flow (83.2%).
By making this adjustment, your logic will no longer be comparing two different points on two different curves. It will correctly predict the peak performance of the trimmed impeller and then assess how close the duty point is to that peak, exactly as a pump engineer would. This change will close the final gap between your results and the manufacturer's data.