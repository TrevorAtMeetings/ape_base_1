{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-lg-12">
            <!-- Header Section -->
            <div class="bg-primary text-white p-4 rounded mb-4">
                <h1 class="mb-2">
                    <i data-feather="check-circle" class="me-2"></i>
                    Pump Selection Results
                </h1>
                <p class="mb-0 fs-5">
                    Found {{ pump_selections|length }} suitable pump{{ 's' if pump_selections|length != 1 else '' }} 
                    for your requirements: <strong>{{ "%.1f"|format(site_requirements['flow_m3hr']) }} mÂ³/hr</strong> 
                    at <strong>{{ "%.1f"|format(site_requirements['head_m']) }} m</strong> head
                </p>
            </div>

            <!-- Pump Selection List -->
            <div class="card">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i data-feather="list" class="me-2"></i>
                        Recommended Pumps (Ranked by Suitability Score)
                    </h5>
                </div>
                <div class="card-body p-0">
                    <div class="list-group list-group-flush">
                        {% for pump in pump_selections %}
                            <a href="{{ url_for('reports.pump_report', 
                                              pump_code=pump['pump_code'], 
                                              flow=site_requirements['flow_m3hr'], 
                                              head=site_requirements['head_m'], 
                                              pump_type=site_requirements['pump_type']) }}" 
                               class="list-group-item list-group-item-action p-4 border-bottom">
                                
                                <div class="d-flex w-100 justify-content-between align-items-start mb-3">
                                    <div>
                                        <h5 class="mb-1 text-primary">
                                            <i data-feather="settings" class="me-2"></i>
                                            {{ pump['pump_code'] }}
                                        </h5>
                                        <p class="text-muted mb-1">{{ pump['pump']['manufacturer'] }} - {{ pump['pump']['pump_type'] }}</p>
                                    </div>
                                    <div class="text-end">
                                        <span class="badge bg-success fs-6 px-3 py-2">
                                            Score: {{ "%.1f"|format(pump['suitability_score']) }}
                                        </span>
                                    </div>
                                </div>
                                
                                <!-- Performance Summary -->
                                <div class="row text-center">
                                    <div class="col-md-3">
                                        <div class="border rounded p-2">
                                            <i data-feather="activity" class="text-primary mb-1"></i>
                                            <div class="fw-bold">{{ "%.1f"|format(pump['performance']['efficiency_pct']) }}%</div>
                                            <small class="text-muted">Efficiency</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="border rounded p-2">
                                            <i data-feather="zap" class="text-warning mb-1"></i>
                                            <div class="fw-bold">{{ "%.1f"|format(pump['performance']['power_kw']) }} kW</div>
                                            <small class="text-muted">Power</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="border rounded p-2">
                                            <i data-feather="droplet" class="text-info mb-1"></i>
                                            <div class="fw-bold">{{ "%.1f"|format(pump['performance']['npsh_m']) }} m</div>
                                            <small class="text-muted">NPSH</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="border rounded p-2">
                                            <i data-feather="rotate-cw" class="text-secondary mb-1"></i>
                                            <div class="fw-bold">{{ pump['sizing_info']['impeller_trim_pct']|round|int }}%</div>
                                            <small class="text-muted">Impeller Trim</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Action Hint -->
                                <div class="mt-3 text-center">
                                    <small class="text-primary">
                                        <i data-feather="eye" style="width: 14px; height: 14px;"></i>
                                        Click to view detailed performance analysis & PDF report
                                    </small>
                                </div>
                            </a>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="mt-4 text-center">
                <a href="{{ url_for('main_flow.index') }}" class="btn btn-outline-secondary">
                    <i data-feather="arrow-left" class="me-2"></i>
                    Start New Selection
                </a>
            </div>
        </div>
    </div>
</div>

<script>
// Initialize Feather Icons
if (typeof feather !== 'undefined') {
    feather.replace();
}
</script>
{% endblock %}