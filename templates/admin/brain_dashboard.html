{% extends "base.html" %}

{% block title %}Brain Administration Dashboard{% endblock %}

{% block head %}
<style>
.brain-dashboard {
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.stat-number {
    font-size: 2.5em;
    font-weight: bold;
    color: #2c5aa0;
    margin-bottom: 10px;
}

.stat-label {
    color: #666;
    font-size: 0.9em;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.critical { color: #d73027; }
.major { color: #f46d43; }
.good { color: #1a9641; }

.admin-sections {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.admin-section {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.admin-section h3 {
    margin-top: 0;
    color: #2c5aa0;
    border-bottom: 2px solid #e9ecef;
    padding-bottom: 10px;
}

.section-description {
    color: #666;
    margin-bottom: 15px;
    line-height: 1.4;
}

.section-actions {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.btn {
    display: inline-block;
    padding: 8px 16px;
    background: #2c5aa0;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    font-size: 0.9em;
    transition: background 0.3s;
}

.btn:hover {
    background: #1e4080;
    color: white;
}

.btn-secondary {
    background: #6c757d;
}

.btn-secondary:hover {
    background: #545b62;
}

.system-status {
    background: #f8f9fa;
    border-left: 4px solid #1a9641;
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 4px;
}

.system-status.warning {
    border-left-color: #f46d43;
}

.system-status.critical {
    border-left-color: #d73027;
}

.breadcrumb {
    background: transparent;
    padding: 0;
    margin-bottom: 20px;
}

.breadcrumb-item + .breadcrumb-item::before {
    content: "â†’";
}
</style>
{% endblock %}

{% block content %}
<div class="brain-dashboard">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/admin">Admin</a></li>
            <li class="breadcrumb-item active">Brain System</li>
        </ol>
    </nav>

    <h1>ðŸ§  Brain System Administration</h1>
    
    <!-- System Status -->
    <div class="system-status {% if stats.critical_issues > 0 %}critical{% elif stats.major_issues > 0 %}warning{% endif %}">
        <strong>System Status:</strong> 
        {% if stats.critical_issues > 0 %}
            Critical issues detected - immediate attention required
        {% elif stats.major_issues > 0 %}
            Warning - major data quality issues found
        {% else %}
            System operating normally
        {% endif %}
        <br>
        <small>Production Configuration: {{ stats.production_config or 'default' }}</small>
    </div>

    <!-- Statistics Overview -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number {% if stats.critical_issues > 0 %}critical{% elif stats.major_issues > 0 %}major{% else %}good{% endif %}">
                {{ stats.total_quality_issues or 0 }}
            </div>
            <div class="stat-label">Data Quality Issues</div>
        </div>

        <div class="stat-card">
            <div class="stat-number critical">{{ stats.critical_issues or 0 }}</div>
            <div class="stat-label">Critical Issues</div>
        </div>

        <div class="stat-card">
            <div class="stat-number major">{{ stats.major_issues or 0 }}</div>
            <div class="stat-label">Major Issues</div>
        </div>

        <div class="stat-card">
            <div class="stat-number good">{{ stats.active_corrections or 0 }}</div>
            <div class="stat-label">Active Corrections</div>
        </div>
    </div>

    <!-- Administration Sections -->
    <div class="admin-sections">
        <!-- Data Quality Management -->
        <div class="admin-section">
            <h3>Data Quality Management</h3>
            <p class="section-description">
                Monitor and manage data quality issues across all pump specifications and performance curves. 
                Identify inconsistencies, outliers, and missing data that could affect selection accuracy.
            </p>
            <div class="section-actions">
                <a href="/admin/brain/data-quality" class="btn">View Quality Issues</a>
                <a href="/api/brain/quality-check/8K" class="btn btn-secondary">Run Quality Scan</a>
            </div>
        </div>

        <!-- Data Corrections System -->
        <div class="admin-section">
            <h3>Data Corrections System</h3>
            <p class="section-description">
                Manage the overlay correction system. Propose, review, and approve corrections to pump data 
                without modifying the golden source database. All changes are auditable and reversible.
            </p>
            <div class="section-actions">
                <a href="/admin/brain/corrections" class="btn">Manage Corrections</a>
                <a href="#" onclick="proposeCorrection()" class="btn btn-secondary">Propose Correction</a>
            </div>
        </div>

        <!-- Brain Logic Workbench -->
        <div class="admin-section">
            <h3>Brain Logic Workbench</h3>
            <p class="section-description">
                Test and validate Brain logic changes in a safe environment. Simulate different configurations, 
                test corrections, and analyze the impact before deploying to production.
            </p>
            <div class="section-actions">
                <a href="/admin/brain/workbench" class="btn">Open Workbench</a>
                <a href="#" onclick="testScenario()" class="btn btn-secondary">Test Scenario</a>
            </div>
        </div>

        <!-- Configuration Management -->
        <div class="admin-section">
            <h3>Configuration Management</h3>
            <p class="section-description">
                Manage Brain configuration profiles for different use cases. Create, test, and deploy 
                configurations with different scoring weights and logic parameters.
            </p>
            <div class="section-actions">
                <a href="/admin/config" class="btn">Configuration Manager</a>
                <a href="#" onclick="createProfile()" class="btn btn-secondary">New Profile</a>
            </div>
        </div>

        <!-- Manufacturer Comparison -->
        <div class="admin-section">
            <h3>Manufacturer Comparison</h3>
            <p class="section-description">
                Compare Brain selections against manufacturer recommendations. Upload datasheets, 
                analyze differences, and identify opportunities for improvement.
            </p>
            <div class="section-actions">
                <a href="#" onclick="alert('Coming Soon - Phase 2')" class="btn">Comparison Tool</a>
                <a href="#" onclick="alert('Coming Soon')" class="btn btn-secondary">Upload Datasheet</a>
            </div>
        </div>

        <!-- Decision Analytics -->
        <div class="admin-section">
            <h3>Decision Analytics</h3>
            <p class="section-description">
                Analyze Brain decision patterns, track accuracy improvements over time, 
                and generate reports on system performance and reliability.
            </p>
            <div class="section-actions">
                <a href="/brain/metrics" class="btn">View Analytics</a>
                <a href="#" onclick="generateReport()" class="btn btn-secondary">Generate Report</a>
            </div>
        </div>
    </div>
</div>

<script>
function proposeCorrection() {
    const pumpCode = prompt('Enter pump code:');
    if (pumpCode) {
        window.location.href = `/admin/brain/corrections?pump=${pumpCode}`;
    }
}

function testScenario() {
    const flow = prompt('Enter flow rate (mÂ³/hr):');
    const head = prompt('Enter head (m):');
    if (flow && head) {
        window.location.href = `/admin/brain/workbench?flow=${flow}&head=${head}`;
    }
}

function createProfile() {
    window.location.href = '/admin/config?action=create';
}

function generateReport() {
    alert('Report generation feature coming soon');
}
</script>
{% endblock %}