{% extends "admin/base.html" %}

{% block admin_title %}Data Quality Management{% endblock %}

{% block admin_content %}
<div class="container">
        <h1 class="blue-text text-darken-2" style="margin-bottom: 30px;">
            <i class="material-icons left">assessment</i>
            Data Quality Management
        </h1>

        <!-- Statistics Overview -->
        <div class="row">
            <div class="col s12 m3">
                <div class="card">
                    <div class="card-content center-align">
                        <h3 class="blue-text">{{ total_issues }}</h3>
                        <p class="grey-text">Total Issues</p>
                    </div>
                </div>
            </div>
            <div class="col s12 m3">
                <div class="card">
                    <div class="card-content center-align">
                        <h3 class="red-text">{{ issues_by_severity.critical|length }}</h3>
                        <p class="grey-text">Critical</p>
                    </div>
                </div>
            </div>
            <div class="col s12 m3">
                <div class="card">
                    <div class="card-content center-align">
                        <h3 class="orange-text">{{ issues_by_severity.major|length }}</h3>
                        <p class="grey-text">Major</p>
                    </div>
                </div>
            </div>
            <div class="col s12 m3">
                <div class="card">
                    <div class="card-content center-align">
                        <h3 class="yellow-text text-darken-2">{{ issues_by_severity.minor|length }}</h3>
                        <p class="grey-text">Minor</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Issues by Severity -->
        <div class="row">
            <!-- Critical Issues -->
            <div class="col s12 l4">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title red-text">
                            <i class="material-icons left">error</i>
                            Critical Issues
                            <span class="badge red white-text">{{ issues_by_severity.critical|length }}</span>
                        </span>
                        {% if issues_by_severity.critical %}
                            {% for issue in issues_by_severity.critical %}
                            <div class="card-panel red lighten-5" style="margin: 8px 0; padding: 10px;">
                                <strong class="blue-text">{{ issue.pump_code }}</strong>
                                <span class="grey-text"> - {{ issue.field_name }}</span>
                                <p class="grey-text" style="margin: 4px 0 0 0; font-size: 0.9em;">{{ issue.description }}</p>
                            </div>
                            {% endfor %}
                        {% else %}
                            <p class="grey-text center-align" style="margin-top: 20px;">No critical issues found</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Major Issues -->
            <div class="col s12 l4">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title orange-text">
                            <i class="material-icons left">warning</i>
                            Major Issues
                            <span class="badge orange white-text">{{ issues_by_severity.major|length }}</span>
                        </span>
                        {% if issues_by_severity.major %}
                            {% for issue in issues_by_severity.major %}
                            <div class="card-panel orange lighten-5" style="margin: 8px 0; padding: 10px;">
                                <strong class="blue-text">{{ issue.pump_code }}</strong>
                                <span class="grey-text"> - {{ issue.field_name }}</span>
                                <p class="grey-text" style="margin: 4px 0 0 0; font-size: 0.9em;">{{ issue.description }}</p>
                            </div>
                            {% endfor %}
                        {% else %}
                            <p class="grey-text center-align" style="margin-top: 20px;">No major issues found</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Minor Issues -->
            <div class="col s12 l4">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title yellow-text text-darken-2">
                            <i class="material-icons left">info</i>
                            Minor Issues
                            <span class="badge yellow darken-2 white-text">{{ issues_by_severity.minor|length }}</span>
                        </span>
                        {% if issues_by_severity.minor %}
                            {% for issue in issues_by_severity.minor %}
                            <div class="card-panel yellow lighten-4" style="margin: 8px 0; padding: 10px;">
                                <strong class="blue-text">{{ issue.pump_code }}</strong>
                                <span class="grey-text"> - {{ issue.field_name }}</span>
                                <p class="grey-text" style="margin: 4px 0 0 0; font-size: 0.9em;">{{ issue.description }}</p>
                            </div>
                            {% endfor %}
                        {% else %}
                            <p class="grey-text center-align" style="margin-top: 20px;">No minor issues found</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="row">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">Quality Management Actions</span>
                        <div class="card-action">
                            <a href="/admin/brain" class="btn blue">
                                <i class="material-icons left">arrow_back</i>
                                Back to Brain Dashboard
                            </a>
                            <a href="#" class="btn green disabled">
                                <i class="material-icons left">play_arrow</i>
                                Run Quality Scan
                            </a>
                            <a href="/admin/brain/corrections" class="btn orange">
                                <i class="material-icons left">edit</i>
                                Manage Corrections
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock admin_content %}